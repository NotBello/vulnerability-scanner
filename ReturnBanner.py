#!/usr/bin/python3

# Created by Venujan Malaiyandi
# This is a simple PoC for using retv function from socket library 
# Scans the first 1000 ports

from socket import *

def getBanner(IP, port):
	try:
		setdefaulttimeout(2)
		sk = socket()
		sk.connect((IP,port))
		banner = sk.recv(1024)
		return banner 
	except:
		return

def startMain():
	IP = input("[+] Enter IP Address : ")
	
	for port in range(1,1001):
		banner = getBanner(IP, port)
		if banner:
			banner_str = banner.decode('utf-8', 'ignore').strip()
            		 
			print("[+]" + IP + " / " + str(port) +" : "+ banner_str) 
startMain()


